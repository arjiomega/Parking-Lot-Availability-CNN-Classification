# Parking Lot Availability (Binary Image Classification MobileNetv2)


![output (5)](https://user-images.githubusercontent.com/103622027/231610975-639025f8-1945-4380-a995-736e32774d90.gif)


This project is an improved version of this previous parking lot availability counter that only counts the available pixels in each parking space [project repo](https://github.com/arjiomega/CarPark_ComputerVision). This one uses a binary image classification model to predict if a certain parking space is available. It performs a little bit better than the previous one but it cant run real time or much more computationally expensive.

The gif shown above is generated by predicting all spaces frame by frame for the whole video using opencv.

**PROS**: Stabler than previous solution

**CONS**: Computationally expensive, Mispredicts when the car parked is not aligned properly (same applies for the previous version)

## How it works

![frames](https://animotica.azurewebsites.net/blog/wp-content/uploads/2020/05/frames-per-second-diagram-1024x458.png)

img src: https://animotica.azurewebsites.net

We iterate over the frames of the video then process each frame before running it to a machine learning model.

<br>

![img1](https://i.imgur.com/0NkMhEN.png)


We extract each parking spaces from the current frame we are iterating as mentioned earlier.

<br>


![img2](https://i.imgur.com/aOwbWRK.png)


the parking spaces extracted are then stacked together for batch prediction using the trained machine learning model. By using the example gif above as an example, we have 400 parking spaces so the stacked images shape is going to be (400,width,height,3). The model will then give an output of length 400 with 1s and 0s. The frame is then updated according to the output of the model. The updated frame is then showed using opencv.



## SETUP
setup environment using miniconda
```bash
conda create --no-default-packages -n <env_name>
conda activate <env_name>
conda install python=3.9
```
install required libraries
```bash
pip install -r requirements.txt
```
